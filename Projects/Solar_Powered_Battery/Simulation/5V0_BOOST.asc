Version 4
SHEET 1 1172 1568
WIRE 704 48 656 48
WIRE 832 48 768 48
WIRE -464 128 -544 128
WIRE -400 128 -464 128
WIRE -224 128 -304 128
WIRE 16 128 -144 128
WIRE 256 128 16 128
WIRE 464 128 320 128
WIRE 576 128 464 128
WIRE 656 128 656 48
WIRE 656 128 576 128
WIRE 704 128 656 128
WIRE 832 128 832 48
WIRE 832 128 768 128
WIRE 944 128 832 128
WIRE -464 160 -464 128
WIRE 576 176 576 128
WIRE 16 192 16 128
WIRE 112 192 16 192
WIRE 16 208 16 192
WIRE 112 224 112 192
WIRE 464 224 464 128
WIRE -464 256 -464 224
WIRE 576 272 576 240
WIRE -32 288 -80 288
WIRE -448 304 -544 304
WIRE 16 336 16 304
WIRE 112 336 112 288
WIRE 112 336 16 336
WIRE 464 352 464 304
WIRE -80 368 -80 288
WIRE 16 368 16 336
WIRE 464 400 464 352
WIRE -320 480 -320 176
WIRE -80 480 -80 368
WIRE 176 512 176 448
WIRE 304 512 304 448
WIRE 464 528 464 480
WIRE 176 544 176 512
WIRE 304 544 304 512
WIRE -320 624 -320 560
WIRE -80 624 -80 560
WIRE 176 688 176 624
WIRE 304 688 304 624
FLAG 464 528 0
FLAG 464 352 fb
FLAG 944 128 out
IOPIN 944 128 Out
FLAG -544 128 in
IOPIN -544 128 In
FLAG 576 272 0
FLAG 304 512 comp
FLAG 176 512 ramp
FLAG -80 624 0
FLAG 176 688 0
FLAG 304 688 0
FLAG -544 304 EN
IOPIN -544 304 In
FLAG 16 368 0
FLAG -80 368 gate
FLAG -320 624 0
FLAG -464 256 0
SYMBOL res 448 208 R0
SYMATTR InstName R2
SYMATTR Value 10k
SYMBOL res 448 384 R0
SYMATTR InstName R3
SYMATTR Value 10k
SYMBOL cap 560 176 R0
SYMATTR InstName C1
SYMATTR Value 47µ
SYMBOL ind -240 144 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L1
SYMATTR Value 100µ
SYMATTR SpiceLine Rser=30m
SYMBOL schottky 256 144 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D1
SYMATTR Value 1N5817
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL bv 304 528 R0
WINDOW 3 -45 32 VRight 2
SYMATTR Value V=((V(fb)-2.5) * gain+Vst/2)
SYMATTR InstName B2
SYMBOL voltage 176 528 M0
WINDOW 3 63 438 VLeft 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR Value PULSE(0 {Vst} 0 {Tp} 1p 0 {Tp})
SYMATTR InstName V1
SYMBOL bv -80 464 R0
WINDOW 3 -53 20 VRight 2
SYMATTR Value V=(if( V(in)<Vuv, 10, if(V(EN)<Ven,10, if(V(ramp)>V(comp),0, 10))))
SYMATTR InstName B3
SYMBOL nmos -32 208 R0
SYMATTR InstName M2
SYMATTR Value Si7336ADP
SYMBOL diode 704 144 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D2
SYMATTR Value MYD4
SYMBOL diode 768 32 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName D3
SYMATTR Value MYD4
SYMBOL nmos -400 176 R270
SYMATTR InstName M1
SYMATTR Value Si7336ADP
SYMBOL bv -320 464 R0
WINDOW 3 -53 20 VRight 2
SYMATTR Value V=(if(V(en)<Ven,0,30))
SYMATTR InstName B1
SYMBOL schottky 128 288 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D4
SYMATTR Value 1N5817
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL cap -480 160 R0
SYMATTR InstName C2
SYMATTR Value 10µ
TEXT 704 504 Left 2 !.param freq=100e3\n.param tp=1/freq\n.param Vst 10\n.param gain 1000\n.param Vuv 2\n.param Ven 1.4
TEXT 800 232 Left 2 !.model myd4 d(ron=0, ilimit=4)
