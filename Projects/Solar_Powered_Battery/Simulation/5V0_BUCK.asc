Version 4
SHEET 1 920 1568
WIRE -48 128 -160 128
WIRE 176 128 48 128
WIRE 240 128 176 128
WIRE 464 128 320 128
WIRE 576 128 464 128
WIRE 656 128 576 128
WIRE 576 176 576 128
WIRE 176 208 176 128
WIRE 464 224 464 128
WIRE 576 272 576 240
WIRE 176 320 176 272
WIRE 464 352 464 304
WIRE 464 400 464 352
WIRE 176 512 176 448
WIRE 304 512 304 448
WIRE 464 528 464 480
WIRE 32 544 32 176
WIRE 176 544 176 512
WIRE 304 544 304 512
WIRE 32 688 32 624
WIRE 176 688 176 624
WIRE 304 688 304 624
FLAG 464 528 0
FLAG 464 352 fb
FLAG 656 128 out
IOPIN 656 128 Out
FLAG -160 128 in
IOPIN -160 128 In
FLAG 576 272 0
FLAG 176 320 0
FLAG 304 512 comp
FLAG 176 512 ramp
FLAG 32 688 0
FLAG 176 688 0
FLAG 304 688 0
SYMBOL res 448 208 R0
SYMATTR InstName R2
SYMATTR Value 10k
SYMBOL res 448 384 R0
SYMATTR InstName R3
SYMATTR Value 10k
SYMBOL cap 560 176 R0
SYMATTR InstName C1
SYMATTR Value 10µ
SYMBOL ind 336 112 R90
WINDOW 0 5 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName L1
SYMATTR Value 4.7µ
SYMATTR SpiceLine Rser=10m
SYMBOL schottky 192 272 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D1
SYMATTR Value 1N5817
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL bv 304 528 R0
WINDOW 3 -45 32 VRight 2
SYMATTR Value V=((V(fb)-2.5) * gain+Vst/2)
SYMATTR InstName B2
SYMBOL voltage 176 528 M0
WINDOW 3 63 438 VLeft 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR Value PULSE(0 {Vst} 0 {Tp} 1p 0 {Tp})
SYMATTR InstName V1
SYMBOL bv 32 528 R0
WINDOW 3 -53 20 VRight 2
SYMATTR Value V=(if(V(ramp)>V(comp),50, 0))
SYMATTR InstName B3
SYMBOL nmos -48 176 R270
SYMATTR InstName M2
SYMATTR Value Si7336ADP
TEXT -248 -160 Left 2 !.model MY2N2222 NPN(IS=1E-14 VAF=100\n+   BF=200 IKF=0.3 XTB=1.5 BR=3\n+   CJC=8E-12 CJE=25E-12 TR=100E-9 TF=400E-12\n+   ITF=1 VTF=2 XTF=3 RB=10 RC=.3 RE=.002 Vceo=30 Icrating=800m  mfg=NXP)
TEXT 704 504 Left 2 !.param freq=25e3\n.param tp=1/freq\n.param Vst 5\n.param gain 1000
