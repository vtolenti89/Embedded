* C:\Users\vtolenti89\Documents\05_Electronics\Kicad\Projects\Solar_Powered_Battery\Simulation\Transition_Testbench.asc
V1 N005 0 PWL(0 0 15u 12 400u 12 415u 0)
D1 N005 N006 SP_D
D2 N006 N005 SP_D
R1 N006 SPV 10m
BUCK N003 0 V=if(V(SPV)>3.6,5,0)
BAT_CH N010 0 V=if(V(off_sw)<0.5,0,if(V(BUCK_5V0)>4,4.2,0))
D3 N010 N011 BAT_D
D4 N011 N010 BAT_D
C1 BAT 0 1m
R2 N011 BAT 10m
C2 BUCK_5V0 0 10µ
R3 N004 BUCK_5V0 10m
D5 N003 N004 BUCK_D
D6 N004 N003 BUCK_D
BOOST N008 0 V=if(V(BOOST_EN)<0.5,0, if(V(BAT)>2,5,0))
C3 BOOST_5V0 0 10µ
R4 N009 BOOST_5V0 10m
D8 N009 N008 BOOST_D
D7 N008 N009 BOOST_D
V2 BOOST_EN 0 1
R5 SPV op_V- 47k
R6 op_V- 0 47k
R8 BAT op_V+ 47k
R7 op_out N013 100
Q1 off_sw N013 0 0 BC847C
R9 BAT off_sw 10k
C4 op_out 0 1n
XU2 op_V+ op_V- BAT 0 op_out LTC6241
Q2 on_sw N014 0 0 BC847C
R10 BAT on_sw 10k
R11 off_sw N014 100k
M1 BUCK_5V0 N002 N001 N001 Si4433DY
RLOAD load 0 50
M2 BOOST_5V0 N012 N007 N007 Si4433DY
M3 load N012 N007 N007 Si4433DY
M4 load N002 N001 N001 Si4433DY
R12 N007 N012 10k
R13 N001 N002 10k
M5 N002 off_sw 0 0 BSP89
R14 off_sw 0 100k
M6 N012 on_sw 0 0 BSP89
R15 on_sw 0 100k
C5 load 0 10µ
.model D D
.lib C:\Users\vtolenti89\Documents\LTspiceXVII\lib\cmp\standard.dio
.model NPN NPN
.model PNP PNP
.lib C:\Users\vtolenti89\Documents\LTspiceXVII\lib\cmp\standard.bjt
.model NMOS NMOS
.model PMOS PMOS
.lib C:\Users\vtolenti89\Documents\LTspiceXVII\lib\cmp\standard.mos
* Max current is 160mA
.model SP_D D(ron=0, ilimit=160m)
.model BUCK_D D(ron=0, ilimit=3)
.model BAT_D D(ron=0, ilimit=150m)
.model BOOST_D D(ron=0, ilimit=4)
.tran 700u startup
.ic V(bat)=4.2
* connect to EN of boost
* connect to charger
.lib LTC4.lib
.backanno
.end
